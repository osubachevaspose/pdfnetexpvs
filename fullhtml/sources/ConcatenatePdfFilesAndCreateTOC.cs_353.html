<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>ConcatenatePdfFilesAndCreateTOC.cs</title>
  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.5.1.min.js"></script>
</head>
<body>
<pre><code class = "cs">
<a name="ln1">// This is an independent project of an individual developer. Dear PVS-Studio, please check it.</a>
<a name="ln2">// PVS-Studio Static Code Analyzer for C, C++, C#, and Java: https://pvs-studio.com</a>
<a name="ln3">using System.IO;</a>
<a name="ln4">using System;</a>
<a name="ln5">using Aspose.Pdf.Facades;</a>
<a name="ln6"> </a>
<a name="ln7">namespace Aspose.Pdf.Examples.CSharp.AsposePDFFacades.TechnicalArticles</a>
<a name="ln8">{</a>
<a name="ln9">    public class ConcatenatePdfFilesAndCreateTOC</a>
<a name="ln10">    {</a>
<a name="ln11">        public static void Run()</a>
<a name="ln12">        {</a>
<a name="ln13">            // ExStart:ConcatenatePdfFilesAndCreateTOC</a>
<a name="ln14">            // The path to the documents directory.</a>
<a name="ln15">            string dataDir = RunExamples.GetDataDir_AsposePdfFacades_TechnicalArticles();</a>
<a name="ln16"> </a>
<a name="ln17">            // Create PdfFileEditor object</a>
<a name="ln18">            PdfFileEditor pdfEditor = new PdfFileEditor();</a>
<a name="ln19">            // Save concatenated output file</a>
<a name="ln20">            pdfEditor.Concatenate(new FileStream(dataDir + &quot;input1.pdf&quot;, FileMode.Open), new FileStream(dataDir + &quot;input2.pdf&quot;, FileMode.Open), new FileStream(dataDir + &quot;ConcatenatePdfFilesAndCreateTOC_out.pdf&quot;, FileMode.Create));</a>
<a name="ln21">            // ExEnd:ConcatenatePdfFilesAndCreateTOC                      </a>
<a name="ln22">        }</a>
<a name="ln23">        public static void InsertBlankPage()</a>
<a name="ln24">        {</a>
<a name="ln25">            // ExStart:InsertBlankPage</a>
<a name="ln26">            // The path to the documents directory.</a>
<a name="ln27">            string dataDir = RunExamples.GetDataDir_AsposePdfFacades_TechnicalArticles();</a>
<a name="ln28"> </a>
<a name="ln29">            // Insert a blank page at the begining of concatenated file to display Table of Contents</a>
<a name="ln30">            Aspose.Pdf.Document concatenated_pdfDocument = new Aspose.Pdf.Document(new FileStream(dataDir + &quot;Concatenated_Table_Of_Contents.pdf&quot;, FileMode.Open));</a>
<a name="ln31">            // Insert a empty page in a PDF</a>
<a name="ln32">            concatenated_pdfDocument.Pages.Insert(1);</a>
<a name="ln33">            // ExEnd:InsertBlankPage</a>
<a name="ln34">        }</a>
<a name="ln35">        public static void AddTextStamps()</a>
<a name="ln36">        {</a>
<a name="ln37">            // ExStart:AddTextStamps</a>
<a name="ln38">            // The path to the documents directory.</a>
<a name="ln39">            string dataDir = RunExamples.GetDataDir_AsposePdfFacades_TechnicalArticles();</a>
<a name="ln40"> </a>
<a name="ln41">            // Set Text Stamp to display string Table Of Contents</a>
<a name="ln42">            Aspose.Pdf.Facades.Stamp stamp = new Aspose.Pdf.Facades.Stamp();</a>
<a name="ln43">            stamp.BindLogo(new FormattedText(&quot;Table Of Contents&quot;, System.Drawing.Color.Maroon, System.Drawing.Color.Transparent, Aspose.Pdf.Facades.FontStyle.Helvetica, EncodingType.Winansi, true, 18));</a>
<a name="ln44">            // Specify the origin of Stamp. We are getting the page width and specifying the X coordinate for stamp</a>
<a name="ln45">            stamp.SetOrigin((new PdfFileInfo(new FileStream(dataDir + &quot;input1.pdf&quot;, FileMode.Open)).GetPageWidth(1) / 3), 700);</a>
<a name="ln46">            // Set particular pages</a>
<a name="ln47">            stamp.Pages = new int[] { 1 };           </a>
<a name="ln48">            // ExEnd:AddTextStamps</a>
<a name="ln49">        }</a>
<a name="ln50">        public static void CreateLocalLinks()</a>
<a name="ln51">        {</a>
<a name="ln52">            // ExStart:CreateLocalLinks</a>
<a name="ln53">            // The path to the documents directory.</a>
<a name="ln54">            string dataDir = RunExamples.GetDataDir_AsposePdfFacades_TechnicalArticles();</a>
<a name="ln55"> </a>
<a name="ln56">            // Now we need to add Heading for Table Of Contents and links for documents</a>
<a name="ln57">            PdfContentEditor contentEditor = new PdfContentEditor();</a>
<a name="ln58">            // Bind the PDF file in which we added the blank page</a>
<a name="ln59">            contentEditor.BindPdf(new FileStream(dataDir + &quot;Concatenated_Table_Of_Contents.pdf&quot;, FileMode.Open));</a>
<a name="ln60">            // Create link for first document</a>
<a name="ln61">            contentEditor.CreateLocalLink(new System.Drawing.Rectangle(150, 650, 100, 20), 2, 1, System.Drawing.Color.Transparent);</a>
<a name="ln62">            // ExEnd:CreateLocalLinks</a>
<a name="ln63">        }</a>
<a name="ln64">        public static void CompletedCode()</a>
<a name="ln65">        {</a>
<a name="ln66">            // ExStart:CompletedCode</a>
<a name="ln67">            // The path to the documents directory.</a>
<a name="ln68">            string dataDir = RunExamples.GetDataDir_AsposePdfFacades_TechnicalArticles();</a>
<a name="ln69"> </a>
<a name="ln70">            // Create PdfFileEditor object</a>
<a name="ln71">            PdfFileEditor pdfEditor = new PdfFileEditor();</a>
<a name="ln72">            // Create a MemoryStream object to hold the resultant PDf file</a>
<a name="ln73">            using (MemoryStream Concatenated_Stream = new MemoryStream())</a>
<a name="ln74">            {</a>
<a name="ln75">                // Save concatenated output file</a>
<a name="ln76">                pdfEditor.Concatenate(new FileStream(dataDir + &quot;input1.pdf&quot;, FileMode.Open), new FileStream(dataDir + &quot;input2.pdf&quot;, FileMode.Open), Concatenated_Stream);</a>
<a name="ln77">                // Insert a blank page at the begining of concatenated file to display Table of Contents</a>
<a name="ln78">                Aspose.Pdf.Document concatenated_pdfDocument = new Aspose.Pdf.Document(Concatenated_Stream);</a>
<a name="ln79">                // Insert a empty page in a PDF</a>
<a name="ln80">                concatenated_pdfDocument.Pages.Insert(1);</a>
<a name="ln81"> </a>
<a name="ln82">                // Hold the resultnat file with empty page added</a>
<a name="ln83">                using (MemoryStream Document_With_BlankPage = new MemoryStream())</a>
<a name="ln84">                {</a>
<a name="ln85">                    // Save output file</a>
<a name="ln86">                    concatenated_pdfDocument.Save(Document_With_BlankPage);</a>
<a name="ln87"> </a>
<a name="ln88">                    using (var Document_with_TOC_Heading = new MemoryStream())</a>
<a name="ln89">                    {</a>
<a name="ln90">                        // Add Table Of Contents logo as stamp to PDF file</a>
<a name="ln91">                        PdfFileStamp fileStamp = new PdfFileStamp();</a>
<a name="ln92">                        // Find the input file</a>
<a name="ln93">                        fileStamp.BindPdf(Document_With_BlankPage);</a>
<a name="ln94"> </a>
<a name="ln95">                        // Set Text Stamp to display string Table Of Contents</a>
<a name="ln96">                        Aspose.Pdf.Facades.Stamp stamp = new Aspose.Pdf.Facades.Stamp();</a>
<a name="ln97">                        stamp.BindLogo(new FormattedText(&quot;Table Of Contents&quot;, System.Drawing.Color.Maroon, System.Drawing.Color.Transparent, Aspose.Pdf.Facades.FontStyle.Helvetica, EncodingType.Winansi, true, 18));</a>
<a name="ln98">                        // Specify the origin of Stamp. We are getting the page width and specifying the X coordinate for stamp</a>
<a name="ln99">                        stamp.SetOrigin((new PdfFileInfo(Document_With_BlankPage).GetPageWidth(1) / 3), 700);</a>
<a name="ln100">                        // Set particular pages</a>
<a name="ln101">                        stamp.Pages = new int[] { 1 };</a>
<a name="ln102">                        // Add stamp to PDF file</a>
<a name="ln103">                        fileStamp.AddStamp(stamp);</a>
<a name="ln104"> </a>
<a name="ln105">                        // Create stamp text for first item in Table Of Contents</a>
<a name="ln106">                        var Document1_Link = new Aspose.Pdf.Facades.Stamp();</a>
<a name="ln107">                        Document1_Link.BindLogo(new FormattedText(&quot;1 - Link to Document 1&quot;, System.Drawing.Color.Black, System.Drawing.Color.Transparent, Aspose.Pdf.Facades.FontStyle.Helvetica, EncodingType.Winansi, true, 12));</a>
<a name="ln108">                        // Specify the origin of Stamp. We are getting the page width and specifying the X coordinate for stamp</a>
<a name="ln109">                        Document1_Link.SetOrigin(150, 650);</a>
<a name="ln110">                        // Set particular pages on which stamp should be displayed</a>
<a name="ln111">                        Document1_Link.Pages = new int[] { 1 };</a>
<a name="ln112">                        // Add stamp to PDF file</a>
<a name="ln113">                        fileStamp.AddStamp(Document1_Link);</a>
<a name="ln114"> </a>
<a name="ln115">                        // Create stamp text for second item in Table Of Contents</a>
<a name="ln116">                        var Document2_Link = new Aspose.Pdf.Facades.Stamp();</a>
<a name="ln117">                        Document2_Link.BindLogo(new FormattedText(&quot;2 - Link to Document 2&quot;, System.Drawing.Color.Black, System.Drawing.Color.Transparent, Aspose.Pdf.Facades.FontStyle.Helvetica, EncodingType.Winansi, true, 12));</a>
<a name="ln118">                        // Specify the origin of Stamp. We are getting the page width and specifying the X coordinate for stamp</a>
<a name="ln119">                        Document2_Link.SetOrigin(150, 620);</a>
<a name="ln120">                        // Set particular pages on which stamp should be displayed</a>
<a name="ln121">                        Document2_Link.Pages = new int[] { 1 };</a>
<a name="ln122">                        // Add stamp to PDF file</a>
<a name="ln123">                        fileStamp.AddStamp(Document2_Link);</a>
<a name="ln124"> </a>
<a name="ln125">                        // Save updated PDF file</a>
<a name="ln126">                        fileStamp.Save(Document_with_TOC_Heading);</a>
<a name="ln127">                        fileStamp.Close();</a>
<a name="ln128"> </a>
<a name="ln129">                        // Now we need to add Heading for Table Of Contents and links for documents</a>
<a name="ln130">                        PdfContentEditor contentEditor = new PdfContentEditor();</a>
<a name="ln131">                        // Bind the PDF file in which we added the blank page</a>
<a name="ln132">                        contentEditor.BindPdf(Document_with_TOC_Heading);</a>
<a name="ln133">                        // Create link for first document</a>
<a name="ln134">                        contentEditor.CreateLocalLink(new System.Drawing.Rectangle(150, 650, 100, 20), 2, 1, System.Drawing.Color.Transparent);</a>
<a name="ln135">                        // Create link for Second document</a>
<a name="ln136">                        // We have used   new PdfFileInfo(&quot;d:/pdftest/Input1.pdf&quot;).NumberOfPages + 2   as PdfFileInfo.NumberOfPages(..) returns the page count for first document</a>
<a name="ln137">                        // And 2 is because, second document will start at Input1+1 and 1 for the page containing Table Of Contents.</a>
<a name="ln138">                        contentEditor.CreateLocalLink(new System.Drawing.Rectangle(150, 620, 100, 20), new PdfFileInfo(dataDir + &quot;Input1.pdf&quot;).NumberOfPages + 2, 1, System.Drawing.Color.Transparent);</a>
<a name="ln139"> </a>
<a name="ln140">                        // Save updated PDF</a>
<a name="ln141">                        contentEditor.Save( dataDir + &quot;Concatenated_Table_Of_Contents.pdf&quot;);</a>
<a name="ln142">                    }</a>
<a name="ln143">                }</a>
<a name="ln144">            }</a>
<a name="ln145">            // ExEnd:CompletedCode</a>
<a name="ln146">        }</a>
<a name="ln147">    }</a>
<a name="ln148">}</a>
</code></pre>
<div class="balloon" rel="57"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3114/" target="_blank">V3114</a> IDisposable object 'contentEditor' is not disposed before method returns.</p></div>
<div class="balloon" rel="130"><p><span style="font-size:18px">&uarr;</span> <a href="https://pvs-studio.com/en/docs/warnings/v3114/" target="_blank">V3114</a> IDisposable object 'contentEditor' is not disposed before method returns.</p></div>
<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>